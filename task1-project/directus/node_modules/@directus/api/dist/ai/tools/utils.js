import { sanitizeQuery } from '../../utils/sanitize-query.js';
/**
 * Build a sanitized query object from a tool's args payload.
 * - Ensures fields defaults to '*' when not provided
 * - Returns an empty object when no args.query is present
 */
export async function buildSanitizedQueryFromArgs(args, schema, accountability) {
    let sanitizedQuery = {};
    if (args?.query) {
        const q = args.query;
        sanitizedQuery = await sanitizeQuery({
            fields: q['fields'] ?? '*',
            ...q,
        }, schema, accountability ?? undefined);
    }
    return sanitizedQuery;
}
